CNOT2_GATE(a1,b1,a10,b10)
CNOT2_GATE(c0,d0,c01,d01)
CNOT2_GATE(b10,c01,b11,c02)
SWAP_GATE(a10,b11,b12,a11)
SWAP_GATE(c02,d01,d02,s1)
FREDKIN1_GATE(b12,a11,d02,d03,c1,f0)
SWAP_GATE(d03,c1,c11,d04)
SWAP_GATE(d1,c11,c12,d11)
CNOT2_GATE(a2,b2,a20,b20)
CNOT2_GATE(c12,d11,c13,d12)
CNOT2_GATE(b20,c13,b21,c14)
SWAP_GATE(a20,b21,b22,a21)
SWAP_GATE(c14,d12,d13,s2)
FREDKIN1_GATE(b22,a21,d13,d14,c2,f1)
SWAP_GATE(d14,c2,c21,d15)
SWAP_GATE(d2,c21,c22,d21)
CNOT2_GATE(a3,b3,a30,b30)
CNOT2_GATE(c22,d21,c23,d22)
CNOT2_GATE(b30,c23,b31,c24)
SWAP_GATE(a30,b31,b32,a31)
SWAP_GATE(c24,d22,d23,s3)
FREDKIN1_GATE(b32,a31,d23,d24,c3,f2)